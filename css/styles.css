/* ============================================================
   Eagle Eye Tree - Styles (v3.2)
   ============================================================ */
:root {
  --bg1:#0c1222; --bg2:#111827; --bg3:#1e293b; --bg4:#334155;
  --text1:#e2e8f0; --text2:#94a3b8; --text3:#64748b; --text4:#475569;
  --blue:#3b82f6; --green:#10b981; --red:#ef4444; --amber:#f59e0b;
}
* { box-sizing:border-box; margin:0; padding:0; }
body { font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; background:var(--bg1); color:var(--text1); }

/* ═══ LAYOUT ═══ */
.app-layout { display:flex; height:100vh; overflow:hidden; }
.sidebar { width:420px; background:var(--bg2); display:flex; flex-direction:column; border-right:1px solid var(--bg3); transition:width .2s; flex-shrink:0; }
.main-area { flex:1; display:flex; flex-direction:column; overflow:hidden; position:relative; }

/* ═══ HEADER ═══ */
.sidebar-header { padding:10px 12px; border-bottom:1px solid var(--bg3); }
.status-dot { width:8px; height:8px; border-radius:50%; background:var(--amber); }
.tag-badge { font-size:10px; font-weight:700; background:var(--bg3); color:var(--text2); padding:2px 8px; border-radius:4px; }
.stats { font-size:10px; color:var(--text3); margin-top:3px; }

/* ═══ TABS ═══ */
.tab-bar { display:flex; padding:6px 12px; gap:4px; }
.tab { flex:1; padding:6px 0; border:none; background:var(--bg3); color:var(--text2); font-size:11px; font-weight:700; cursor:pointer; border-radius:5px; transition:all .15s; }
.tab.active { background:var(--blue); color:#fff; }
.tab:hover:not(.active) { background:var(--bg4); }

/* ═══ SEARCH ═══ */
.search-box { width:100%; padding:6px 10px; border:1px solid var(--bg3); border-radius:5px; background:var(--bg1); color:var(--text1); font-size:12px; outline:none; }
.search-box:focus { border-color:var(--blue); }

/* ═══ ECN ═══ */
.ecn-toggle { padding:4px 12px; border:1px solid var(--bg4); border-radius:4px; background:var(--bg3); color:var(--text2); font-size:11px; font-weight:700; cursor:pointer; }
.ecn-toggle.ecn-active { background:var(--amber); color:#000; border-color:var(--amber); }
.ecn-brushes { display:flex; gap:4px; margin-top:6px; flex-wrap:wrap; }
.ecn-brush-btn { padding:3px 8px; border:1px solid var(--c, var(--bg4)); border-radius:3px; background:transparent; color:var(--c, var(--text2)); font-size:10px; cursor:pointer; }
.ecn-brush-btn.active { background:var(--c); color:#fff; }
.ecn-summary { font-size:10px; color:var(--amber); font-weight:700; margin-top:4px; }

/* ═══ LIST VIEW ═══ */
.sidebar-scroll { flex:1; overflow-y:auto; padding:0 0 80px; }
.group-section { margin-bottom:2px; }
.group-hdr { display:flex; align-items:center; gap:8px; padding:8px 12px; cursor:pointer; background:var(--bg3); }
.group-hdr:hover { background:var(--bg4); }
.arrow { font-size:8px; color:var(--text3); transition:transform .15s; }
.arrow.open { transform:rotate(90deg); }
.glabel { flex:1; font-size:12px; font-weight:700; }
.gcnt { font-size:10px; color:var(--text3); background:var(--bg1); padding:1px 6px; border-radius:8px; }
.ecn-cnt { font-size:9px; color:var(--amber); font-weight:800; }

.step-row { display:flex; align-items:center; gap:6px; padding:5px 12px; cursor:pointer; border-left:3px solid transparent; transition:all .1s; }
.step-row:hover { background:rgba(255,255,255,0.03); }
.step-row.selected { background:rgba(59,130,246,0.1); border-left-color:var(--blue); }
.sid-edit {
  font-size:11px; font-weight:700; color:var(--text3); min-width:22px; text-align:center;
  cursor:pointer; padding:1px 4px; border-radius:4px; border:1px dashed transparent;
  transition:all .15s;
}
.sid-edit:hover { border-color:var(--blue); background:rgba(59,130,246,0.08); color:var(--blue); }
.sid-edit.has-tag { color:#7c3aed; font-weight:800; font-style:italic; border-color:#7c3aed40; background:#7c3aed08; }
.badge { font-size:8px; font-weight:800; padding:2px 5px; border-radius:3px; }
.badge-step { background:#3b82f620; color:#60a5fa; }
.badge-prep { background:#f59e0b20; color:#fbbf24; }
.badge-kanryo { background:#ef444420; color:#f87171; }
.badge-note { background:#8b5cf620; color:#a78bfa; }
.slabel { flex:1; font-size:12px; color:var(--text1); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.slabel.kanryo { color:var(--amber); font-weight:700; }
.ecn-mark { font-size:14px; font-weight:900; }
.tag { font-size:9px; font-weight:700; padding:1px 5px; border-radius:3px; }
.tag-p { background:#10b98118; color:#34d399; }
.tag-f { background:#ef444418; color:#fca5a5; }

/* ═══ REORDER ARROWS ═══ */
.reorder-arrows { display:flex; flex-direction:column; gap:0; margin-right:2px; }
.arr-btn {
  font-size:8px; line-height:1; color:var(--text4); cursor:pointer;
  padding:2px 4px; border-radius:2px; user-select:none; transition:all .1s;
}
.arr-btn:hover:not(.dim) { color:var(--blue); background:rgba(96,165,250,0.15); }
.arr-btn.dim { opacity:0.15; cursor:default; }
.part-reorder { display:flex; flex-direction:column; gap:0; margin-right:4px; }
.arr-sm {
  font-size:7px; line-height:1; color:var(--text4); cursor:pointer;
  padding:1px 3px; border-radius:2px; user-select:none;
}
.arr-sm:hover:not(.dim) { color:var(--green); background:rgba(16,185,129,0.15); }
.arr-sm.dim { opacity:0.15; cursor:default; }

/* ═══ DETAIL PANEL ═══ */
.main-detail { width:100%; max-height:50vh; overflow-y:auto; border-bottom:1px solid var(--bg3); background:var(--bg2); }
.empty-detail { display:flex; flex-direction:column; align-items:center; justify-content:center; height:200px; color:var(--text3); font-size:12px; gap:6px; }
.detail-hdr { display:flex; align-items:flex-start; gap:8px; padding:12px; border-bottom:1px solid var(--bg3); }
.section-title { font-size:10px; font-weight:800; padding:8px 12px 4px; letter-spacing:0.05em; }
.item-row { display:flex; align-items:center; gap:6px; padding:3px 12px; }
.dot { width:5px; height:5px; border-radius:50%; flex-shrink:0; }
.mono { font-size:11px; font-family:monospace; }
.iqty { font-size:10px; font-weight:700; }
.ecn-badge { font-size:9px; font-weight:700; padding:2px 6px; border-radius:3px; }

/* ═══ GRAPH TOOLBAR ═══ */
.graph-toolbar { display:flex; align-items:center; gap:6px; padding:6px 12px; background:var(--bg2); border-bottom:1px solid var(--bg3); flex-wrap:wrap; }
.tool-btn { padding:4px 10px; border:1px solid var(--bg4); border-radius:4px; background:var(--bg3); color:var(--text2); font-size:11px; font-weight:600; cursor:pointer; }
.tool-btn.active { background:var(--blue); color:#fff; border-color:var(--blue); }
.tool-btn:hover { background:var(--bg4); }
.toolbar-status { font-size:10px; color:var(--text3); margin-left:auto; }

/* ═══ FLOATING SPACING PANEL ═══ */
.spacing-panel {
  position:absolute; top:52px; right:16px; z-index:150;
  background:var(--bg2); border:1px solid var(--bg4); border-radius:10px;
  padding:0; width:320px; box-shadow:0 8px 24px rgba(0,0,0,0.4);
}
.spacing-panel-header {
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 14px; border-bottom:1px solid var(--bg3);
  font-size:13px; font-weight:800; color:var(--text1);
}
.spacing-close {
  background:none; border:none; color:var(--text3); font-size:18px;
  cursor:pointer; padding:0 4px; line-height:1;
}
.spacing-close:hover { color:var(--text1); }
.spacing-row {
  display:flex; align-items:center; gap:8px; padding:10px 14px;
}
.spacing-label { font-size:11px; font-weight:600; color:var(--text2); min-width:105px; }
.spacing-row input[type="range"] { flex:1; height:4px; accent-color:var(--blue); cursor:pointer; }
.spacing-num {
  width:52px; padding:3px 6px; border:1px solid var(--bg4); border-radius:4px;
  background:var(--bg3); color:var(--text1); font-size:12px; font-family:monospace;
  text-align:center;
}
.spacing-num:focus { border-color:var(--blue); outline:none; }
.spacing-unit { font-size:10px; color:var(--text4); }
.spacing-actions {
  display:flex; gap:8px; padding:8px 14px 12px; border-top:1px solid var(--bg3);
}
.spacing-action-btn {
  flex:1; padding:6px 0; border:1px solid var(--bg4); border-radius:6px;
  background:var(--bg3); color:var(--text2); font-size:11px; font-weight:700;
  cursor:pointer; text-align:center;
}
.spacing-action-btn:hover { background:var(--bg4); color:var(--text1); }

/* ═══ GROUP FILTER BAR ═══ */
.group-filter-bar { display:flex; align-items:center; gap:6px; padding:4px 12px; background:var(--bg1); border-bottom:1px solid var(--bg3); flex-wrap:wrap; }
.filter-label { font-size:10px; font-weight:700; color:var(--text3); }
.filter-chips { display:flex; gap:4px; flex-wrap:wrap; }
.filter-chip {
  padding:3px 10px; border:1px solid var(--bg4); border-radius:12px;
  background:var(--bg3); color:var(--text2); font-size:10px; font-weight:600;
  cursor:pointer; transition:all .15s; white-space:nowrap;
}
.filter-chip.active { background:var(--blue); color:#fff; border-color:var(--blue); }
.filter-chip:hover:not(.active) { background:var(--bg4); }
.filter-chip.filter-ecn { border-color:var(--amber); color:var(--amber); }
.filter-chip.filter-ecn.active { background:var(--amber); color:#000; }
.filter-chip .chip-dot { display:inline-block; width:6px; height:6px; border-radius:50%; margin-right:4px; }

/* ═══ TREE CONTAINER ═══ */
.tree-container { flex:1; position:relative; overflow:hidden; background:#fafbfc; }
.tree-container svg { display:block; }
.zoom-controls { position:absolute; right:12px; bottom:40px; display:flex; flex-direction:column; gap:4px; }
.zoom-btn { width:30px; height:30px; border:1px solid #ddd; border-radius:4px; background:white; font-size:16px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
.zoom-btn:hover { background:#f0f0f0; }
.legend { position:absolute; bottom:8px; left:50%; transform:translateX(-50%); display:flex; gap:10px; align-items:center; font-size:10px; background:rgba(255,255,255,0.9); padding:4px 12px; border-radius:12px; }
.legend-item { display:flex; align-items:center; gap:4px; }
.legend-swatch { width:10px; height:10px; border-radius:2px; }

/* ═══ KANBAN ═══ */
.kanban-container { flex:1; display:flex; gap:10px; padding:12px; overflow-x:auto; background:var(--bg1); }
.kan-col { min-width:190px; max-width:220px; background:var(--bg2); border-radius:8px; display:flex; flex-direction:column; }
.kan-hdr { padding:8px 10px; border-radius:8px 8px 0 0; }
.kan-cards { flex:1; overflow-y:auto; padding:6px; display:flex; flex-direction:column; gap:4px; }
.kan-card { padding:6px 8px; background:var(--bg3); border-radius:5px; border-left:3px solid transparent; cursor:pointer; }
.kan-card:hover { background:var(--bg4); }
.kan-card.selected { border-left-color:var(--blue); background:rgba(59,130,246,0.1); }

/* ═══ CONTEXT MENU ═══ */
.ctx-menu { position:fixed; background:var(--bg2); border:1px solid var(--bg4); border-radius:6px; padding:4px 0; min-width:160px; z-index:200; box-shadow:0 4px 12px rgba(0,0,0,0.3); }
.ctx-item { padding:6px 14px; font-size:12px; cursor:pointer; color:var(--text1); }
.ctx-item:hover { background:var(--bg3); }
.ctx-item.danger { color:var(--red); }
.ctx-sep { height:1px; background:var(--bg3); margin:3px 0; }

/* ═══ MODAL ═══ */
.modal-overlay { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:250; display:flex; align-items:center; justify-content:center; }
.modal { background:var(--bg2); border:1px solid var(--bg4); border-radius:8px; padding:20px; min-width:300px; max-width:400px; }

/* ═══ TOAST ═══ */
.toast {
  position:fixed; bottom:20px; right:20px;
  padding:8px 16px; border-radius:6px; font-size:11px; font-weight:600;
  color:#fff; z-index:300; animation:fadeIn .2s;
}
@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; } }
